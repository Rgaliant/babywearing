
<h1>User Listing</h1>

<table class="table table-striped">
  <thead class="thead-dark">
    <tr>
      <th scope="col">Email Address</th>
      <th scope="col">First Name</th>
      <th scope="col">Last Name</th>
      <th scope="col">Role</th>
      <th scope="col">Edit</th>
    </tr>
  </thead>

  <% @users.each do |user| %>              
    <tr>
        <td class="p-2"><%= user.email %></td>
        <td class="p-2"><%= user.full_name.split(" ").first %></td>
        <td class="p-2"><%= user.full_name.split(" ").last %></td>
        <td class="p-2">
        <%= form_with model: user, local: true do |form| %>
          <%= form.select :role, Role.all.collect {|p| [ p.name, p.id ] }, onchange: "this.form.submit();" %>          
        <% end %>
        </td>
        <td class="p-2"><%= link_to 'Edit', edit_user_path(user.id) %></td>
    </tr>
  <% end %>

  <%= button_to "Export to CSV", "/users.csv", :method => :get%>
</table>
