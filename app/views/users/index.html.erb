
<h1>User Listing</h1>

<table class="table table-striped">
  <thead class="thead-light">
    <tr>
      <th scope="col" class="sort-header"><%= link_to "Email Address", :sort => "email" %></th>
      <th scope="col" class="sort-header"><%= link_to "First Name", :sort => "first_name" %></th>
      <th scope="col" class="sort-header"><%= link_to "Last Name", :sort => "last_name" %></th>
      <th scope="col">Role</th>
      <th scope="col">Edit</th>
    </tr>
  </thead>

  <% @users.each do |user| %>              
    <tr>
        <td class="p-2"><%= user.email %></td>
        <td class="p-2"><%= user.first_name %></td>
        <td class="p-2"><%= user.last_name %></td>
        <td class="p-2">
        <%= form_with model: user, local: true do |form| %>
          <%= form.select :role, Role.all.collect {|p| [ p.name, p.id ] }, onchange: "this.form.submit();" %>          
        <% end %>
        </td>
        <td class="p-2"><%= link_to 'Edit', edit_user_path(user.id) %></td>
    </tr>
  <% end %>

  <%= button_to "Export to CSV", "/users.csv", :method => :get%>
</table>
